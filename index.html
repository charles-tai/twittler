<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
  </head>
  <body>
    <script>

      $(document).ready(function(){

        //initial tweets

        var $divTweets = $( 'div.tweets' )
        var index = streams.home.length - 1;
        var count = 0;
        while(index >= 0){
          var tweet = streams.home[index];
          var $tweet = $('<div></div>');
          $tweet.html('@' + tweet.user + ': ' + tweet.message + '\</br\>' +" date created: " + tweet.created_at);
          $tweet.appendTo($divTweets);
          index -= 1;
          count++;
        }

        //display new tweets
        var previousIndex = count;

        $('button.new').on('click', function() {
          var index = streams.home.length-1;
          console.log('index:' + index);
          console.log('previousIndex:' + previousIndex );

          while(index >= previousIndex) {
            var tweet = streams.home[index];
            var $newTweet = $('<div id = \'toggle\'></div>');
            $newTweet.html('@' + tweet.user + ': ' + tweet.message + '\n date created: ' + tweet.created_at + '<b> tweet #:' + index);
            $newTweet.prependTo($('div.newTweet')).effect('highlight',{color:'#F4E9C9'}, 10000);
            index--;
            count++;
          }
            console.log('count: ' + count);
            previousIndex = count;
        })

        setInterval(function () {numOfTweets(streams.home.length-count)},1000);
      });
      function numOfTweets (count) {
        $('div.numOfTweets').text('new message: ' + count);
      }



    </script>

    <button type = 'button' class = 'new'> new tweets </button>
    <div class = 'numOfTweets'> </div>
    <div class = 'newTweet'></div>
    <div class = 'tweets'></div>

  </body>

</html>
